(this["webpackJsonpkeystone-client"]=this["webpackJsonpkeystone-client"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(79),s=n.n(c),i=(n(95),n(19)),o=n(17),l=n(7),d=n(86),j=n(114),u=n(116),b=n(113),p=n(83),m=n(9),h=n(87),O=n(23),x="UPDATE_PROPERTIES",f=function(e,t){return t.type===x?Object(i.a)(Object(i.a)({},e),{},{properties:Object(O.a)(t.properties)}):e};var g=n(3),v=["value"],y=Object(r.createContext)(),w=y.Provider,k=function(e){e.value;var t,n=Object(h.a)(e,v),a=(t={properties:[]},Object(r.useReducer)(f,t)),c=Object(m.a)(a,2),s=c[0],o=c[1];return Object(g.jsx)(w,Object(i.a)({value:[s,o]},n))},S=function(){return Object(r.useContext)(y)};n.p;var _,N,P,$,C=function(){var e=S(),t=Object(m.a)(e,2),n=t[0];return t[1],n.currentCategory,Object(g.jsxs)("div",{className:"my-2",children:[Object(g.jsx)("h2",{children:"House List:"}),n.properties.length?Object(g.jsx)("div",{className:"flex-row",children:n.properties.map((function(e){return Object(g.jsxs)("li",{children:["_id=",e._id,"images=",e.image,"address=",e.address,"value=",e.value,"price=",e.forSale]},e._id)}))}):Object(g.jsx)("h3",{children:"No Properties"})]})},E=n(118),F=n(33),A=n(115),z=Object(A.a)(_||(_=Object(F.a)(["\n query getProperty($id: ID!) {\n  property(_id: $id) {\n    _id\n    address\n    address2\n    city\n    state\n    country\n    zip\n    value\n    lat\n    lng\n    description\n    images\n    forSale\n    salePrice\n    sqft\n    bedrooms\n    bathrooms\n    yearBuilt\n    ifNft\n    NftUri\n  }\n  user {\n    _id\n    name\n    email\n    properties {\n      _id\n      address\n      address2\n      city\n      state\n      country\n      zip\n      value\n      lat\n      lng\n      description\n      images\n      forSale\n      salePrice\n      sqft\n      bedrooms\n      bathrooms\n      yearBuilt\n      ifNft\n      NftUri\n    }\n  }\n}\n"]))),I=Object(A.a)(N||(N=Object(F.a)(["\n  query getProperties {\n  properties {\n    _id\n    address\n    address2\n    city\n    state\n    country\n    zip\n    value\n    lat\n    lng\n    description\n    images\n    forSale\n    salePrice\n  }\n}\n"]))),R=(Object(A.a)(P||(P=Object(F.a)(["\n  query getSaleProperties {\n  properties(forSale: true) {\n    _id\n    address\n    address2\n    city\n    state\n    country\n    zip\n    value\n    lat\n    lng\n    description\n    images\n    forSale\n    salePrice\n  }\n}\n"]))),Object(A.a)($||($=Object(F.a)(["\n  query User {\n  user {\n    _id\n    name\n    email\n    properties {\n      _id\n      address\n      address2\n      city\n      state\n      country\n      zip\n      value\n      lat\n      lng\n      description\n      images\n      forSale\n      salePrice\n    }\n  }\n}\n"])))),T=function(){var e=S(),t=Object(m.a)(e,2),n=t[0],a=t[1],c=(n.currentCategory,Object(E.a)(I)),s=c.loading,i=c.data;return Object(r.useEffect)((function(){i&&a({type:x,properties:i.properties})}),[i,s,a]),Object(g.jsx)("div",{className:"container",children:Object(g.jsx)(C,{})})};var U,L,D,W=function(e){var t=e.children;return Object(g.jsx)("div",{style:{height:560,clear:"both",paddingTop:120,textAlign:"center"},children:t})},q=function(){return Object(g.jsx)("div",{children:Object(g.jsxs)(W,{children:[Object(g.jsx)("h1",{children:"404 Page Not Found"}),Object(g.jsx)("h1",{children:Object(g.jsx)("span",{role:"img","aria-label":"Face With Rolling Eyes Emoji",children:"\ud83d\ude44"})})]})})},B=n(14),G=n(8),H=n(15),J=n(111),K=Object(A.a)(U||(U=Object(F.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n      }\n    }\n  }\n"]))),M=Object(A.a)(L||(L=Object(F.a)(["\n  mutation addProperty($address: String, $city: String, $state: String, $zip: String) {\n    addProperty(address: $address, city: $city, state: $state, zip: $zip) {\n      _id\n      address\n      address2\n      city\n      state\n      country\n      zip\n      value\n      description\n      images\n      forSale\n      salePrice\n    }\n  }\n"]))),Q=Object(A.a)(D||(D=Object(F.a)(["\n  mutation addUser($name: String!, $email: String!, $password: String!) {\n    addUser(name: $name, email: $email, password: $password) {\n      token\n      user {\n        _id\n        name\n        email\n        properties {\n          _id\n          address\n        }\n      }\n    }\n  }\n"]))),V=n(20),X=n(21),Y=n(70),Z=n.n(Y),ee=new(function(){function e(){Object(V.a)(this,e)}return Object(X.a)(e,[{key:"getProfile",value:function(){return Z()(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Z()(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}());var te=function(e){var t=Object(r.useState)({email:"",password:""}),n=Object(m.a)(t,2),a=n[0],c=n[1],s=Object(J.a)(K),l=Object(m.a)(s,2),d=l[0],j=l[1].error,u=function(){var e=Object(H.a)(Object(G.a)().mark((function e(t){var n,r;return Object(G.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,d({variables:{email:a.email,password:a.password}});case 4:n=e.sent,r=n.data.login.token,ee.login(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),b=function(e){var t=e.target,n=t.name,r=t.value;c(Object(i.a)(Object(i.a)({},a),{},Object(B.a)({},n,r)))};return Object(g.jsxs)("div",{className:"container my-1",children:[Object(g.jsx)(o.b,{to:"/signup",children:"\u2190 Go to Signup"}),Object(g.jsx)("h2",{children:"Login"}),Object(g.jsxs)("form",{onSubmit:u,children:[Object(g.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(g.jsx)("label",{htmlFor:"email",children:"Email address:"}),Object(g.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:b})]}),Object(g.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(g.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(g.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:b})]}),j?Object(g.jsx)("div",{children:Object(g.jsx)("p",{className:"error-text",children:"The provided credentials are incorrect"})}):null,Object(g.jsx)("div",{className:"flex-row flex-end",children:Object(g.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var ne=function(){return ee.loggedIn()?Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"container my-1",children:[Object(g.jsx)(o.b,{to:"/",children:"\u2190 Back to Home"}),Object(g.jsx)(o.b,{to:"/add-property",children:"Add Property"})]})}):null},re=n(66);var ae=function(){var e=Object(l.n)().id,t=Object(E.a)(z,{variables:{_id:e}}),n=(t.loading,t.error,t.data);n&&console.log(n),console.log(undefined);var a=Object(r.useState)(null),c=Object(m.a)(a,2),s=(c[0],c[1]),i=Object(r.useState)(),o=Object(m.a)(i,2),d=o[0],j=o[1],u=function(){var t=Object(H.a)(Object(G.a)().mark((function t(n){var r,a;return Object(G.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),(r=new FormData).append("image",d),r.append("propid",e),t.next=6,re.a.post("/api/image-upload",r,{headers:{"Content-Type":"multipart/form-data"}});case 6:a=t.sent,s("/img/prop/"+a.data.filename);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"container my-1",children:[Object(g.jsx)("h2",{children:"PropertyDetail: "}),Object(g.jsx)("div",{children:Object(g.jsx)("h2",{})}),ee.loggedIn()?Object(g.jsxs)("form",{onSubmit:u,children:[Object(g.jsx)("input",{filename:d,onChange:function(e){return j(e.target.files[0])},type:"file",accept:"image/*"}),Object(g.jsx)("button",{type:"submit",children:"Submit"})]}):Object(g.jsx)("div",{children:"Login"})]})})};var ce,se=n(31);function ie(e,t){(ce=new window.google.maps.places.Autocomplete(t.current,{types:["address"],componentRestrictions:{country:["US"]},fields:["address_components","geometry"]})).setFields(["address_components","formatted_address"]),ce.addListener("place_changed",(function(){return function(e){return oe.apply(this,arguments)}(e)}))}function oe(){return(oe=Object(H.a)(Object(G.a)().mark((function e(t){var n,r;return Object(G.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ce.getPlace(),r=n.formatted_address,t(r);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le=function(e){var t=Object(l.l)(),n=Object(J.a)(M),a=Object(m.a)(n,2),c=a[0],s=(a[1].error,Object(r.useState)("")),i=Object(m.a)(s,2),o=i[0],d=i[1],j=Object(r.useRef)(null),u=Object(r.useState)({address:"",city:"",state:"",zip:"",value:"",description:"",imgURL:""}),b=Object(m.a)(u,2);b[0],b[1],Object(r.useEffect)((function(){!function(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){return t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}("https://maps.googleapis.com/maps/api/js?key=AIzaSyDyfKCmxQxrQqrFnDgMSmj6xxhLnIkbuh8&libraries=places",(function(){return ie(d,j)}))}),[]);var p=Object(E.a)(R).data;p&&p.user;var h=function(){var e=Object(H.a)(Object(G.a)().mark((function e(n){var r,a,s,i,o,l,d,j,u,b;return Object(G.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),console.log(ce.getPlace()),r=ce.getPlace(),a="",s="",i="",o="",l=Object(se.a)(r.address_components),e.prev=8,l.s();case 10:if((d=l.n()).done){e.next=28;break}j=d.value,u=j.types[0],e.t0=u,e.next="street_number"===e.t0?16:"route"===e.t0?18:"postal_code"===e.t0?20:"locality"===e.t0?22:"administrative_area_level_1"===e.t0?24:26;break;case 16:return a="".concat(j.long_name),e.abrupt("break",26);case 18:return a+=" "+j.short_name,e.abrupt("break",26);case 20:return o="".concat(j.long_name),e.abrupt("break",26);case 22:return s="".concat(j.long_name),e.abrupt("break",26);case 24:return i="".concat(j.short_name),e.abrupt("break",26);case 26:e.next=10;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(8),l.e(e.t1);case 33:return e.prev=33,l.f(),e.finish(33);case 36:return console.log(a+s+i+o),e.prev=37,e.next=40,c({variables:{address:a,city:s,state:i,zip:o}});case 40:b=e.sent,console.log("mutationResponse:"),console.log(b),b.data&&t("/property/".concat(b.data.addProperty._id)),e.next=49;break;case 46:e.prev=46,e.t2=e.catch(37),console.log(e.t2);case 49:case"end":return e.stop()}}),e,null,[[8,30,33,36],[37,46]])})));return function(t){return e.apply(this,arguments)}}();return ee.loggedIn()?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"search-location-input"}),Object(g.jsxs)("div",{className:"container my-1",children:["Add Property Form here",Object(g.jsxs)("form",{onSubmit:h,method:"submit",children:[Object(g.jsx)("label",{htmlFor:"fullAddress",children:"Street Address:"}),Object(g.jsx)("input",{ref:j,onChange:function(e){return d(e.target.value)},placeholder:"Enter a City",value:o,id:"fullAddress",size:"80"}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"text",name:"imgURL",placeholder:"https://imghost.com/img.jpg"}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"text",name:"description",placeholder:"property description"}),Object(g.jsx)("br",{}),Object(g.jsx)("input",{type:"text",name:"value",placeholder:"$0?"}),Object(g.jsx)("br",{}),Object(g.jsx)("button",{type:"submit",children:"submit!"})]})]})]}):null};var de=function(e){var t=Object(r.useState)({email:"",password:""}),n=Object(m.a)(t,2),a=n[0],c=n[1],s=Object(J.a)(Q),l=Object(m.a)(s,1)[0],d=function(){var e=Object(H.a)(Object(G.a)().mark((function e(t){var n,r;return Object(G.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,l({variables:{email:a.email,password:a.password,name:a.name}});case 3:n=e.sent,r=n.data.addUser.token,ee.login(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){var t=e.target,n=t.name,r=t.value;c(Object(i.a)(Object(i.a)({},a),{},Object(B.a)({},n,r)))};return Object(g.jsxs)("div",{className:"container my-1",children:[Object(g.jsx)(o.b,{to:"/login",children:"\u2190 Go to Login"}),Object(g.jsx)("h2",{children:"Register"}),Object(g.jsxs)("form",{onSubmit:d,children:[Object(g.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(g.jsx)("label",{htmlFor:"firstName",children:"Name:"}),Object(g.jsx)("input",{placeholder:"Full Name",name:"name",type:"name",id:"name",onChange:j})]}),Object(g.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(g.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(g.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:j})]}),Object(g.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(g.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(g.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:j})]}),Object(g.jsx)("div",{className:"flex-row flex-end",children:Object(g.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var je=function(){return Object(g.jsxs)("header",{className:"flex-row px-1",children:[Object(g.jsx)("h1",{children:Object(g.jsx)(o.b,{to:"/",children:"Keystone"})}),Object(g.jsx)("nav",{children:ee.loggedIn()?Object(g.jsxs)("ul",{className:"flex-row",children:[Object(g.jsx)("li",{className:"mx-1",children:Object(g.jsx)(o.b,{to:"/profile",children:"Profile"})}),Object(g.jsx)("li",{className:"mx-1",children:Object(g.jsx)(o.b,{to:"/add-property",children:"Add Property"})}),Object(g.jsx)("li",{className:"mx-1",children:Object(g.jsx)("a",{href:"/",onClick:function(){return ee.logout()},children:"Logout"})})]}):Object(g.jsxs)("ul",{className:"flex-row",children:[Object(g.jsx)("li",{className:"mx-1",children:Object(g.jsx)(o.b,{to:"/register",children:"Register"})}),Object(g.jsx)("li",{className:"mx-1",children:Object(g.jsx)(o.b,{to:"/login",children:"Login"})})]})})]})},ue=Object(d.a)({uri:"/graphql"}),be=Object(p.a)((function(e,t){var n=t.headers,r=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},n),{},{authorization:r?"Bearer ".concat(r):""})}})),pe=new j.a({link:be.concat(ue),cache:new u.a});var me=function(){return Object(g.jsx)(b.a,{client:pe,children:Object(g.jsx)(o.a,{children:Object(g.jsx)("div",{children:Object(g.jsxs)(k,{children:[Object(g.jsx)(je,{}),Object(g.jsxs)(l.c,{children:[Object(g.jsx)(l.a,{path:"/",element:Object(g.jsx)(T,{})}),Object(g.jsx)(l.a,{path:"/login",element:Object(g.jsx)(te,{})}),Object(g.jsx)(l.a,{path:"/register",element:Object(g.jsx)(de,{})}),Object(g.jsx)(l.a,{path:"/profile",element:Object(g.jsx)(ne,{})}),Object(g.jsx)(l.a,{path:"/add-property",element:Object(g.jsx)(le,{})}),Object(g.jsx)(l.a,{path:"/property/:id",element:Object(g.jsx)(ae,{})}),Object(g.jsx)(l.a,{path:"*",element:Object(g.jsx)(q,{})})]})]})})})})},he=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Oe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(me,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");he?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Oe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Oe(t,e)}))}}()},95:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.be57b2ff.chunk.js.map